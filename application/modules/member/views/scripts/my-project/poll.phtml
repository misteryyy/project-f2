<?php 
$this->step = 9;
echo $this->partial('my-project/my-project-navigation.phtml',array("step" => $this->step,"project" => $this->project));
?>


<div class="fl-cnt-100 create-new">
  <a href="/member/my-project/poll-create/id/<?php echo $this->project->id?>" title="create new poll"><span class="green"><img src="/media/slepice-site/1.0.0/img/icon_new_project.jpg" alt="create new update icon" /> create new poll</span></a>
</div>


<?php if (count($this->paginator)) {?> 
<div class="fl-cnt-100">
<?php echo $this->paginationControl($this->paginator, 'Elastic', 'partials/pagination-control-bootstrap.phtml'); ?> 
</div>
<div class="fl-cnt-100">
        <table class="table table-striped">
        <thead>
    		<tr>
    			<th>Name</th>
    			<th>Questions</th>
    			<th>Created</th>
    			<th>Actions</th>
    		</tr>
    	</thead>
    <tbody>
    <?php foreach ($this->paginator as $poll){ ?>
    	<tr>
    	<td><?php echo $poll->name; ?></td>
		<td>Number of Questions : <?php echo count($poll->questions);?> <br>
			
			<?php foreach($poll->questions as $q){
				echo $q->question  . ": with AVG ".$q->avgOfAnswers()."<br>".PHP_EOL;
			}?>
			
			<?php echo count($poll->questions[0]->answers)." has been voted.";?>
		</td>	
		<td><?php echo $poll->created->format('Y/m/d h:m:s'); ?></td>		
		<td> 
    		<a class="btn btn-info" href="/member/my-project/poll-detail/id/<?php echo $this->project->id?>/poll_id/<?php echo $poll->id ?>">Detail</a> 
    	</td>			
    	</tr>	 		
    <?php } ?>
    </tbody>
    </table>
</div>    	
    		
    <?php }?>





